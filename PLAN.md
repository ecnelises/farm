# 设计

这里是项目必要的分工和设计。

## 类设计

* `Application` 类，整个项目必要的单例，在 `main` 函数里运行 `run` 方法
  * `run` 方法，执行整个主程序
* `Map` 类，表达整个项目的地图，作为所有场景的容器，里面提供接受 `SceneStrategy` 参数的方法，用以遍历整个场景列表，也可作为迭代器
* `Scene` 类，抽象基类，表示一个单独的场景
  * `spawn` 方法，生成场景特有的产物，构成模版方法模式，也可作为工厂方法
* `Player` 类，表示和场景、地图等互动的玩家实体
* `PlayerController` 类，玩家的委托，抽象基类，一些必要的交互方法写在里面，因为我们只是作为一个例子，所以里面写一些简单的输入然后调用 `Player` 的方法就行了
* `PlayerState` 类，玩家的状态，不同的玩家状态调用不同的方法，这个实现独立于 `Player` 类本身
* `Backpack` 类，玩家的背包，作为所有物件的容器
* `BackpackEntry` 类，概念上区分子背包和物件
* `Item` 类，表示可放入背包中的物品
* `Food`、`Tool` 类等都是 `Item` 的子类
* `Animal` 类和 `Crop` 类分别对应 `Pasture` 和 `Farm`，而两者的生成规则可以抽象成为 Strategy，`Animal` 具有 `clone` 方法
* 输出并不属于实体常规动作的一部分，所以用访问者模式来实现，每个实体都接受一个对应类型的访问者。比如 `PlayerVisitor`，定义一组虚函数以输出玩家内容
* `Player` 和 `Scene` 之间构成一种 publish/subscribe 关系，Scene 生成了新产物可以通知 Player
* 背包和地图都可以用享元模式实现
* 输出的部分可以用到装饰器模式
* 通过 `Map` 访问游戏中的 `Scene` 时，返回的不是直接的场景，而是代理类 `SceneProxy`
